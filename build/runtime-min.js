define("kg/xtemplate/4.1.3/runtime",[],function(n,r,t){var e,i,a,o,f;e=function(n){function r(){var n="";for(var r in e)n+=r+"|";return n=n.slice(0,-1),a=new RegExp(n,"g")}var t,e={"&":"&amp;",">":"&gt;","<":"&lt;","`":"&#x60;","/":"&#x2F;",'"':"&quot;","'":"&#x27;"},i=/[&<>"'`]/,a=r(),o=/\\?\{([^{}]+)\}/g,f="undefined"!=typeof global?global:window,u=Object.prototype.toString;return n=t={isArray:Array.isArray||function(n){return"[object Array]"===u.call(n)},keys:Object.keys||function(n){var r,t=[];for(r in n)n.hasOwnProperty(r)&&t.push(r);return t},each:function(n,r,e){if(n){var i,a,o,f=0,u=n&&n.length,s=void 0===u||"[object Function]"===Object.prototype.toString.call(n);if(e=e||null,s)for(o=t.keys(n);f<o.length&&(i=o[f],r.call(e,n[i],i,n)!==!1);f++);else for(a=n[0];u>f&&r.call(e,a,f,n)!==!1;a=n[++f]);}return n},mix:function(n,r){for(var t in r)n[t]=r[t];return n},globalEval:function(n){f.execScript?f.execScript(n):!function(n){f.eval.call(f,n)}(n)},substitute:function(n,r,t){return"string"==typeof n&&r?n.replace(t||o,function(n,t){return"\\"===n.charAt(0)?n.slice(1):void 0===r[t]?"":r[t]}):n},escapeHtml:function(n){return n=""+n,i.test(n)?(n+"").replace(a,function(n){return e[n]}):n},merge:function(){for(var n=0,r=arguments.length,e={};r>n;n++){var i=arguments[n];i&&t.mix(e,i)}return e}}}(),i=function(n){function r(n,r,t){this.data=void 0!==n?n:{},t?(this.parent=t,this.root=t.root):(this.parent=void 0,this.root=this),this.affix=r||{},this.ready=!1}return r.prototype={isScope:1,constructor:r,setParent:function(n){this.parent=n,this.root=n.root},set:function(n,r){this.affix[n]=r},setData:function(n){this.data=n},getData:function(){return this.data},mix:function(n){var r=this.affix;for(var t in n)r[t]=n[t]},get:function(n){var r,t=this.data,e=this.affix;return null!=t&&(r=t[n]),void 0!==r?r:e[n]},resolveInternalOuter:function(n){var r,t=n[0],e=this,i=e;if("this"===t)r=e.data;else if("root"===t)i=i.root,r=i.data;else{if(!t)return[i.data];do r=i.get(t);while(void 0===r&&(i=i.parent))}return[void 0,r]},resolveInternal:function(n){var r=this.resolveInternalOuter(n);if(1===r.length)return r[0];var t,e=n.length,i=r[1];if(void 0===i)return void 0;for(t=1;e>t;t++)i=i[n[t]];return i},resolveLooseInternal:function(n){var r=this.resolveInternalOuter(n);if(1===r.length)return r[0];var t,e=n.length,i=r[1];for(t=1;null!=i&&e>t;t++)i=i[n[t]];return i},resolveUp:function(n){return this.parent&&this.parent.resolveInternal(n)},resolveLooseUp:function(n){return this.parent&&this.parent.resolveLooseInternal(n)},resolveOuter:function(n,r){var t,e=this,i=e;if(!r&&1===n.length){if(t=e.get(n[0]),void 0!==t)return[t];r=1}if(r)for(;i&&r--;)i=i.parent;return i?[void 0,i]:[void 0]},resolveLoose:function(n,r){var t=this.resolveOuter(n,r);return 1===t.length?t[0]:t[1].resolveLooseInternal(n)},resolve:function(n,r){var t=this.resolveOuter(n,r);return 1===t.length?t[0]:t[1].resolveInternal(n)}},n=r}(),a=function(n){function r(n,r,t){this.list=n,this.init(),this.next=r,this.ready=!1,this.tpl=t}function t(n,t){var e=this;e.config=t,e.head=new r(e,void 0),e.callback=n,this.init()}var i=e;return r.prototype={constructor:r,isBuffer:1,init:function(){this.data=""},append:function(n){return this.data+=n,this},write:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=n}return this},writeEscaped:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=i.escapeHtml(n)}return this},insert:function(){var n=this,t=n.list,e=n.tpl,i=new r(t,n.next,e),a=new r(t,i,e);return n.next=a,n.ready=!0,a},async:function(n){var r=this.insert(),t=r.next;return n(r),t},error:function(n){var r=this.list.callback;if(r){var t=this.tpl;if(t){n instanceof Error||(n=new Error(n));var e=t.name,i=t.pos.line,a="XTemplate error in file: "+e+" at line "+i+": ";n.stack=a+n.stack,n.message=a+n.message,n.xtpl={pos:{line:i},name:e}}this.list.callback=null,r(n,void 0)}},end:function(){var n=this;return n.list.callback&&(n.ready=!0,n.list.flush()),n}},t.prototype={constructor:t,init:function(){this.data=""},append:function(n){this.data+=n},end:function(){this.callback(null,this.data),this.callback=null},flush:function(){for(var n=this,r=n.head;r;){if(!r.ready)return n.head=r,void 0;this.data+=r.data,r=r.next}n.end()}},t.Buffer=r,n=t}(),o=function(n){var r=i,t=e,a={range:function(n,r){var t=r.params,e=t[0],i=t[1],a=t[2];a?(e>i&&a>0||i>e&&0>a)&&(a=-a):a=e>i?-1:1;for(var o=[],f=e;i>e?i>f:f>i;f+=a)o.push(f);return o},foreach:function(n,t,e){var i,a,o,f,u=t.params,s=u[0],l=u[2]||"xindex",c=u[1];if(s)for(i=s.length,f=0;i>f;f++)a=new r(s[f],{xcount:i,xindex:f},n),o=a.affix,"xindex"!==l&&(o[l]=f,o.xindex=void 0),c&&(o[c]=s[f]),e=t.fn(a,e);return e},forin:function(n,t,e){var i,a,o,f=t.params,u=f[0],s=f[2]||"xindex",l=f[1];if(u)for(o in u)i=new r(u[o],{xindex:o},n),a=i.affix,"xindex"!==s&&(a[s]=o,a.xindex=void 0),l&&(a[l]=u[o]),e=t.fn(i,e);return e},each:function(n,r,e){var i=r.params,o=i[0];return o?t.isArray(o)?a.foreach(n,r,e):a.forin(n,r,e):e},"with":function(n,t,e){var i=t.params,a=i[0];if(a){var o=new r(a,void 0,n);e=t.fn(o,e)}return e},"if":function(n,r,t){var e=r.params,i=e[0];if(i){var a=r.fn;a&&(t=a(n,t))}else{var o=!1,f=r.elseIfs,u=r.inverse;if(f)for(var s=0,l=f.length;l>s;s++){var c=f[s];if(o=c.test(n)){t=c.fn(n,t);break}}!o&&u&&(t=u(n,t))}return t},set:function(n,r,t){for(var e=r.hash,i=e.length,a=0;i>a;a++){var o=e[a],f=o.key,u=o.depth,s=o.value;if(1===f.length){for(var l=n.root;u&&l!==n;)n=n.parent,--u;n.set(f[0],s)}else{var c=n.resolve(f.slice(0,-1),u);c&&(c[f[f.length-1]]=s)}}return t},include:1,parse:1,extend:1,block:function(n,r,t){var e,i=this,a=i.runtime,o=r.params,f=o[0];2===o.length&&(e=o[0],f=o[1]);var u,s=a.blocks=a.blocks||{},l=s[f],c={fn:r.fn,type:e};if(l){if(l.type)if("append"===l.type)c.next=l,s[f]=c;else if("prepend"===l.type){var v;for(u=l;u&&"prepend"===u.type;)v=u,u=u.next;c.next=u,v.next=c}}else s[f]=c;if(!a.extendTpl)for(u=s[f];u;)u.fn&&(t=u.fn.call(i,n,t)),u=u.next;return t},macro:function(n,t,e){var i=t.hash,a=t.params,o=a[0],f=a.slice(1),u=this,s=u.runtime,l=s.macros=s.macros||{},c=l[o];if(t.fn)l[o]={paramNames:f,hash:i,fn:t.fn};else if(c){var v,d=c.hash||{};if(v=c.paramNames)for(var h=0,p=v.length;p>h;h++){var m=v[h];d[m]=f[h]}if(i)for(var g in i)d[g]=i[g];var x=new r(d);x.root=n.root,e=c.fn.call(u,x,e)}else{var y="can not find macro: "+o;e.error(y)}return e}};return a["debugger"]=function(){},n=a}(),f=function(n){function r(n,r,t,e,i,a,o,f){this.name=n,this.originalName=a||n,this.runtime=r,this.root=t,this.pos={line:1},this.scope=e,this.buffer=i,this.fn=o,this.parent=f}function t(n,r,t){var e=t[0],i=n&&n[e]||r&&r[e]||g[e];if(1===t.length)return i;if(i)for(var a=t.length,o=1;a>o;o++)if(i=i[t[o]],!i)return!1;return i}function f(n,r){var t=n.split("/"),e=r.split("/");t.pop();for(var i=0,a=e.length;a>i;i++){var o=e[i];"."===o||(".."===o?t.pop():t.push(o))}return t.join("/")}function u(n,r,e,i,a,o){var f,u,s;if(o||(s=t(n.runtime.commands,n.root.config.commands,a)),s)return s.call(n,r,e,i);if(s!==!1&&(f=r.resolve(a.slice(0,-1),o),u=f[a[a.length-1]]))try{return u.apply(f,e.params||[])}catch(l){return i.error("Execute function `"+a.join(".")+"` Error: "+l.message),i}return i.error("Command Not Found: "+a.join(".")),i}function s(n,r){var t=this;t.fn=n,t.config=p.merge(s.globalConfig,r),this.subNameResolveCache={}}function l(n,r,t){if("."!==r.charAt(0))return r;var e=t+"_ks_"+r,i=n.subNameResolveCache,a=i[e];return a?a:r=i[e]=f(t,r)}function c(n,r,t,e,i,a){var o=l(n,a,i.name),f=e.insert(),u=f.next;return d(n,o,i.runtime,r,f,a,t,e.tpl),u}function v(n,t,e,i,a){var o=e.insert(),f=o.next,u=new r(a.TPL_NAME,i.runtime,n,t,o,void 0,a,e.tpl);return o.tpl=u,h(u),f}function d(n,t,e,i,a,o,f,u){var s=new r(t,e,n,i,a,o,void 0,u);a.tpl=s,n.config.loader.load(s,function(n,r){"function"==typeof r?(s.fn=r,h(s)):n?a.error(n):(r=r||"",f?a.writeEscaped(r):a.data+=r,a.end())})}function h(n){var r=n.fn();if(r){var t,e=n.runtime,i=e.extendTpl;if(i&&(t=i.params[0],!t))return r.error("extend command required a non-empty parameter");var a=e.extendTplFn,o=e.extendTplBuffer;return a?(e.extendTpl=null,e.extendTplBuffer=null,e.extendTplFn=null,v(n.root,n.scope,o,n,a).end()):t&&(e.extendTpl=null,e.extendTplBuffer=null,c(n.root,n.scope,0,o,n,t).end()),r.end()}}var p=e,m=o,g={},x=i,y=a,b={callFn:u,callDataFn:function(n,r){for(var t=r[0],e=t,i=1;i<r.length;i++){var a=r[i];if(!e||null==e[a])return"";t=e,e=e[a]}return e.apply(t,n||[])},callCommand:function(n,r,t,e,i){return u(n,r,t,e,i)}};return p.mix(s,{config:function(n,r){var t=this.globalConfig=this.globalConfig||{};return arguments.length?(void 0!==r?t[n]=r:p.mix(t,n),void 0):t},nativeCommands:m,utils:b,util:p,addCommand:function(n,r){g[n]=r},removeCommand:function(n){delete g[n]}}),s.prototype={constructor:s,Scope:x,nativeCommands:m,utils:b,removeCommand:function(n){var r=this.config;r.commands&&delete r.commands[n]},addCommand:function(n,r){var t=this.config;t.commands=t.commands||{},t.commands[n]=r},include:function(n,r,t,e){var i,a=r.params;i=n;var o=r.hash,f=r&&r.escape;return o&&(i=new x(o,void 0,n)),a[0]?t=c(this,i,f,t,e,a[0]):t.error("include command required a non-empty parameter")},includeModule:function(n,r,t,e){var i=r.params,a=n,o=r.hash;return o&&(a=new x(o,void 0,n)),i[0]?t=v(this,a,t,e,i[0]):t.error("include command required a non-empty parameter")},render:function(n,t,e){var i="",a=this,o=a.fn,f=a.config;"function"==typeof t&&(e=t,t=null),t=t||{},e=e||function(n,r){if(n)throw n instanceof Error||(n=new Error(n)),n;i=r};var u=a.config.name;!u&&o&&o.TPL_NAME&&(u=o.TPL_NAME);var l;l=n instanceof x?n:new x(n);var c=new s.LinkedBuffer(e,f).head,v=new r(u,{commands:t.commands},a,l,c,u,o);return c.tpl=v,o?(h(v),i):(f.loader.load(v,function(n,r){r?(v.fn=a.fn=r,h(v)):n&&c.error(n)}),i)}},s.Scope=x,s.LinkedBuffer=y,n=s}(),t.exports=f});